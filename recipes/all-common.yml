modules:

  # Copies files from the repo into the image
  - type: files
    files:
      - source: system
        destination: /

  # Signs image with sigstore
  - type: signing

  # Installs chezmoi and automatically imports dotfiles
  - type: chezmoi
    repository: "https://github.com/oakleafknight06/dotfiles"
    
  # Installs fonts
  - type: fonts
    fonts:
      nerd-fonts:
        - ComicShannsMono
        - AdwaitaMono

  # Installs and removes packages
  - type: dnf
    repos:
      files:
        - https://pkgs.tailscale.com/stable/fedora/tailscale.repo
        - https://repository.mullvad.net/rpm/stable/mullvad.repo
        - https://rpm.releases.hashicorp.com/fedora/hashicorp.repo
      copr:
        - name: zeno/scrcpy
          chroot: fedora-43-x86_64
    install:
      packages:
        - tailscale # Effortless networking - "Virtual LAN" wireguard service
        - fish # Fish shell. Not set as login, executed with terminal emulator
        - sg3_utils # Enables Apple SuperDrive udev rule
        - ibus-rime # Better Chiense input
        - mullvad-vpn # Circumvent network censorship
        - android-tools # ADB and fastboot
        - scrcpy # Android screen mirroring
        - syncthing # For syncing things
        - golang # To build Landrun

  # Sets up systemd services installed from packages in the dnf module
  - type: systemd
    system:
      enabled:
        - tailscaled
        - mullvad-daemon

  # Runs scripts from the scripts folder
  - type: script
    scripts:
      - landrun-install.sh # Installs landrun; landlock cli 
      - yubico.sh # Installs Yubico desktop app

