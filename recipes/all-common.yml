modules:
  # Copies files from the repo into the image
  - type: files
    files:
      - source: system
        destination: /

  # Signs image with sigstore
  - type: signing

  # Installs chezmoi and automatically imports dotfiles
  - type: chezmoi
    repository: "https://github.com/oakleafknight06/dotfiles"
    
  # Installs fonts
  - type: fonts
    fonts:
      nerd-fonts:
        - AdwaitaMono
        - ComicShannsMono
      google-fonts:
        - Roboto

  - type: dnf
    repos:
      files:
        - https://pkgs.tailscale.com/stable/fedora/tailscale.repo
        - https://repository.mullvad.net/rpm/stable/mullvad.repo
        - https://packages.freedom.press/yum-tools-prod/dangerzone/dangerzone.repo
      copr:
        - name: zeno/scrcpy
          chroot: fedora-%OS_VERSION%-x86_64
        - name: pesader/showmethekey
          chroot: fedora-%OS_VERSION%-x86_64
    install:
      packages:
        - tailscale # Effortless networking - "Virtual LAN" wireguard service
        - fish # Fish shell. Not set as login, executed with terminal emulator
        - sg3_utils # Enables Apple SuperDrive udev rule
        - ibus-rime # Better Chiense input
        - mullvad-vpn # Circumvent network censorship
        - android-tools # ADB and fastboot
        - scrcpy # Android screen mirroring
        - syncthing # For syncing things
        - golang # To build Landrun
        - dangerzone # Converts dangerous documents to safe pdf
        - showmethekey # Keyboard diagnostics

  - type: systemd
    system:
      enabled:
        - tailscaled
        - mullvad-daemon

  - type: script
    scripts:
      - landrun-install.sh # Installs landrun tool
      - yubico.sh # Yubico desktop app

